---
title: C语言谭浩强笔记
date: 2021-11-26
tags: [C,note]
categories: [note,C]
---

# Chapter1 程序设计和 C 语言

## 计算机程序

## 计算机语言

* 机器语言

* 汇编语言

* 高级语言

## C语言的发展及特点

C语言的特点：

* 语言简洁紧凑，使用方便灵活
* 运算符丰富
* 数据类型丰富
* 具有结构化的控制语句
* 语法限制不严格，程序设计自由度大
* 可以对底层硬件进行操作
* 用C语言写的程序可移植性好
* 代码质量高，执行效率高

## **最简单的C语言程序**

**C语言程序的结构：**

* 一个程序由一个或多个源程序文件组成：预处理指令、全局声明、函数定义等。
* 函数是C语言的主要组成部分：包括函数首部和函数体。

**运行C程序的步骤和方法**

* 输入和编辑源程序
* 编译源程序
* 连接处理
* 运行程序

## **程序执行的任务**

* 问题分析
* 设计算法
* 编写程序
* 编辑、编译和连接程序
* 运行程序，分析结果
* 编写程序文档

# Charpter2 算法——程序的灵魂

## **算法**

一个程序主要包括两方面的信息：

* 对数据的描述。要用到哪些数据以及数据的类型和组织形式即数据结构。
* 对操作的描述。要求计算机进行操作的步骤即算法。

算法 + 数据结构 = 程序

计算机算法可分为两大类别：数值运算和非数值运算算法。

## 算法的特性

* 有穷性。即有限的操作步骤。
* 确定性。步骤明确。
* 有零个或多个输入。
* 有一个或多个输出。
* 有效性。

## 怎样表示一个算法

* 自然语言。文字描述通俗易懂但冗长且容易出现歧义。
* 流程图。顺序结构、分支结构、循环结构。
* N-S流程图。删除了流程线和箭头。
* 伪代码表示。
* 计算机语言表示。

## 结构化程序设计方法

机构化程序设计方法的思路是：把一个复杂问题的求解过程分阶段进行，每个阶段处理的问题控制在人们容易理解和处理的范围内。具体有一下方法：

* 自顶而下
* 逐步细化
* 模块化设计
* 结构化编码

**自顶而下，逐步细化**：考虑周全，结构清晰，层次分明，用工程的方法设计程序。

**自下而上，逐步积累**：适合用于施工阶段。

**模块化设计**：要注意模块的独立性，即使用一个模块完成一项功能，耦合性越少越好。

# chapter3 顺序结构设计

## 设计举例

## 数据的表现形式及其运算

### 常量和变量

#### 常量

* 整型常量
* 实型常量：十进制小数形式、指数形式
* 字符常量：普通字符、转义字符
* 字符串常量：单`''`只能包含一个字符，`""`可以包含一个字符串
* 符号常量：用`#define`指令，指定用一个符号名称代表一个变量

#### 变量

变量必须先定义，后使用，在定义时指定变量的名字和类型

#### 常变量

`const int a = 3;`常变量是有名字的不变量，而常量是没有名字的不变量，有名字就便于在程序中引用

#### 标识符

C语言规定边师傅只能有字母、数字、下划线组成，且第一个标识符不能是数字

### 数据类型

有基本类型（整型和浮点型）、枚举类型`enum`、空类型`void`、派生类型，不同类型的数据在内存中占用的存储单元长度是不同的

### 整型数据

补码：将此数的绝对值写成二进制形式，然后对后面所有的二进位取反再加1

有基本整型`int`、短整型`short int`、长整型`long int`、双长整型`long long int `

`sizeof`是测量类型和变量长度的运算符

在类型前面加上修饰符`unsigned`，表示指定该变量为无符号整数类型，只有正值，不能赋予负值，用`%u`格式输出

### 字符型数据

字符变量用类型复`char`来定义，用`%c`格式输出

### 浮点型数据

`float` 型、`double`型、`long double`型，用`%f`、`%lf`格式输出

### 运算符和表达式

`%`取余，要求运算对象为整数，结果也为整数

自增自减运算符只能用于变量，不能用于常量和表达式

一个字符既可以以字符形式输出（在0-127范围内）、也可以以整数形式输出

强制类型转换运算符，`(int)(x+y)`，（类型名）（表达式）

## C语句

### C语句的作用和分类

控制语句：`if else\for\while\do while\continue\break\switch\return\goto`

函数调用语句：一个函数调用加一个分号组成

表达式语句：一个表达式加一个分号组成

空语句：单独一个分号，作为流程的转换点或者空循环体

复合语句：用{}把一些语句括起来

### 幅值语句

变量能够作为左值，常量、算数表达式、赋值表达式不能作为左值

## 数据的输入输出

### `print`函数输出数据

`print(格式控制，输出表列)`

格式控制：格式声明（%和格式字符组成）、普通字符

输出表列：可以使常量、变量、表达式

格式字符：`%d %f %m.nf %lf %c %s %e %m.ne %o %x %u...`

如果想要输出%，要用连续的两个%%表示

### `scanf`函数输入数据

`scanf(格式控制，地址表列)`

如果在格式控制字符串中除了格式声明以外还有其他字符，则在输入数据时在对应的位置上应输入与这些字符相同的字符。

```c
scanf("%a=f,b=%f,c=%f",&a,&b,&c);
```

应该输入：`a=1,b=3,c=2回车`

### 字符数据的输入输出

`putchar(c)`表示输入字符变量c的值，是一个字符

`getchar()`只能接受一个字符，想要输入多个字符就要用到多个`getchar`函数

# Chapter4 选择结构程序设计

## 选择结构

C语言有两种选择语句：

* if语句，用来实现两个分支的选择机构
* switch语句，用来实现多分支的选择语句

## if语句

if（表达式1）语句1

else if（表达式2）语句2

else（表达式3）语句3

if语句的表达式可以是关系表达式、逻辑表达式和数值表达式

## 关系运算符和关系表达式

## 逻辑运算符和逻辑表达式

优先级为：非>算数运算符>关系运算符>与和或>幅值运算符

## 条件运算符和条件表达式

表达式1？表达式2：表达式3    唯一的三目运算符，可以嵌套

## switch

```c
switch(表达式)
{
case 常量1：语句1；break;
case 常量2：语句2；break;
default: 语句n;
}
说明：
```

# Chapter5 循环结构程序设计

## while循环

```c
while(表达式)
{
    语句；
}
```

## do-while循环

```c
do
{
    语句；
}while（表达式）；
```

## for循环

```c
for(循环变量赋初值；循环条件；循环变量增值)
{
    语句；
}
```

for语句循环功能强大，有些需要注意的点：

* 表达式1和表达式3可以是简单的表达式，也可以是逗号表达式，在逗号表达式内按自左向右顺序求解，逗号表达式的值为最右边的表达式的值

```c
for(i=1;i<=100;i++,i++)sum=sum+i
for（i=1;i<=100;i=i+2）sum=sum+i
```

* 表达式2一般为关系表达式或者是逻辑表达式，但也可以是数值表达式或字符表达式，只要其值为非零，就可以执行循环体

```c
for(;(c=getchar())!='\n';)
    printf("%c", c);
```

上面代码的意思是每读入一个字符就输出一个字符，知道输入一个换行字符为止

## 改变循环执行的状态

`break`用来跳出循环体，即提前结束循环

`continue`用来提前结束本次循环，接着执行下次循环

# Chapter6 数组处理批量数据

数组是一组有序数据的组合

用一个数组名和下标来唯一确定数组中的元素

数组中的每个元素都属于统一类型

将数组和循环结合起来，可以有效处理大量的数据

## 定义和引用数组

**定义数组：**类型符 数组名【常量表达式】

```c
int a[10]
```

* 数组名遵循标识符命名规则
* 数组下标从0开始
* 常量表达式可以是常量或者符号常量，但是不允许做动态定义
* 如果在被调用的函数中定义数组，其长度可以是变量或非常量表达式，因为n的值会从实参传来

```c
void function(int n)
{
	int a[2*n];
}
```

**引用数组:**数组名【下标】

**一维数组的初始化：**定义数组的同时可以给数组元素赋值

* 对全部元素赋值

```c
int a[10] = {0,1,2,3,4,5,6,7,8,9};
```

* 对一部分元素赋值，未赋值的自动初始为0
* 想使数组元素全部为零，可以直接int a[10] = {0};

## 定义和引用二维数组

**定义二维数组：**类型说明符 数组名【常量表达式】【常量表达式】

* 二维数组排列的顺序是按行存放的

**引用二维数组：**数组名【下标】【下标】

**二维数组的初始化：**

* 分别给二维数组赋值，一个花括号对应一行

```c
int a[2][3] = { {1,2,3},{4,5,6} };
```

* 可以将所以数据写到一个花括号中，按照内存顺序进行赋值
* 可以对部分元素赋值
* 对全部元素赋值，第一维长度可以不指定，第二维长度不能省

## 字符数组

C语言中没有字符串类型，字符串是存放在字符型数组中的

**定义字符数组：**char a[10];

**字符数组初始化：**

**引用元素：**for循环遍历

**字符串和字符串结束标志：**

* 实际工作中，更关心的是字符串的有效长度而不是字符数组的长度
* C语言个UI订乐一个字符串结束标志，以`\0`作为结束标志
* C语言在字符数组存储字符常量时自动加一个\0作结束符
* 通过`\0`放在不同位置，可以控制字符串的输出

**字符数组的输入输出：**

* 逐个字符输入输出，用`%c`
* 将整个字符串一次输入输出，用`%s`
* 如果数组长度大于字符串的实际长度，遇到\0结束输出
* 可以用`scanf`输入一个字符串,**数组名**代表该数组的起始位置，不用加&，但是**数组元素**需要加&，如&a[i]

```c
scanf("%s",c);
```

**字符串处理函数：**

* 输出字符串函数`puts(字符数组)`
* 输入字符串函数`gets(字符数组)`
* 字符串连接函数`strcat(字符数组1，字符数组2)`，将2接到1的后面
* 字符串复制函数`strcpy(字符数组1，字符串2)`，将字符串2复制到字符数组1中，字符数组1 必须是数组，2可以是字符串也可以是字符数组，`strncpy`可以将字符串2中的前面n个字符复制到字符数组1中
* 字符串比较函数`strcmp(字符串1，字符串2)`,以第一对不相同的字符的比较结果为准，如果是两个因为字母比较，在英文字典中位置靠后的比较大，小写字母大于大写字母。字符串1=2，返回0；1>2,返回正整数>0；1<2，返回负整数<0
* 测试字符串长度的函数`strlen(字符数组)`，不包括\0
* 转换为小写的函数`strlwr(字符串)`
* 转换为大写的函数`strupr(字符串)`

# Chapter7 函数

每个函数用来实现特定的功能，方便调用，函数不能嵌套定义，但是可以互相调用

## 定义函数

包含函数的名字，函数的类型（即返回值的类型），函数参数德玛名字和类型以及函数的功能

**无参函数：**

```c
类型名 函数名（）
{
	函数体
}
```

**有参函数：**

```c
类型名 函数名（形式参数表列）
{
	函数体
}
```

**空函数:**函数体是空的，没有任何实际作用，可以在准备扩充功能的地方使用

## 调用函数

* 函数名（实参表列）：括号不能省略，参数之间逗号间隔

* 实际参数可以使常量、变量和表达式，但是要有确定的值
* 实参与形参的类型应该相同或赋值兼容
* 返回值的类型要和函数类型一致，以函数类型为准
* 只能由实参传给形参，单向传递
* 调用的函数必须是已经定义的函数，调用前使用函数声明
* 函数不能嵌套定义，但是可以嵌套调用
* 直接或者间接的调用函数本身，称为递归调用
* 数组元素的作用和变量相当，一般来说，凡是变量出现的地方，都可以用数组元素代替，数组元素只能作为函数实参
* 数组名可以作为实参和形参，传递的是数组第一个元素的**地址**
* 用数组名作为函数参数，应该在主调函数和被调用函数分别定义数组
* 形参数组可以不指定大小，跟一个【】
* 在函数内部或者复合语句内部定义的变量称为**局部变量**，哪里定义哪里使用
* 在函数外部定义的变量为**全局变量**，在本文件内都可以使用，第一个字母大写
* 如果变量同名，在局部变量的作用范围内，全局变量被屏蔽不起作用
* `static`全局变量，只能在本文件中被引用
* `extern`全局变量，可以在不同文件中引用
* 内部函数与外部函数与上面全局变量意义一样

# Chapter8 指针

这部分内容复杂琐碎，后面会多看几遍，就先不总结了

# Chapter9  建立数据类型

## 结构体变量

**结构体：**由不同数据类型组成的组合型数据结构，数组智能存放同类型数据

```c
struct 结构体名
{
	成员表列
}；
```

* 成员表列也称为域表，成员命名规则与变量名相同
* 成员可以属于另一个结构体类型

**定义结构体类型变量：**

* 先声明结构体类型，再定义该类型的变量，大程序用的多，随时指定
* 在声明类型的同时定义变量，小程序使用较为方便
* 不指定类型名而直接定义结构体类型变量，不常用

结构体类型的成员名可以与程序中的变量名相同，但二者不代表同一对象

对于结构体变量中的成员可以单独使用，作用相当于普通变量

**结构体变量的初始化和引用：**

* 在定义结构体变量时可以对它的成员初始化

```c
struct Student b = {.name = "Zhou ShenShen"}
```

* 可以引用结构体变量中成员的值，.是成员运算符，在所有运算符中优先级最高

```c
结构体变量名.成员名
```

* 只能对最低级的成员进行赋值或存取以及运算，需要一级一级的找到最低级成员
* 对结构体的成员可以像普通变量一样进行各种运算
* 同类型的结构体变量可以相互赋值
* 可以尹艳红结构体变量成员的地址，也可以引用结构体变量的地址

## 结构体数组

**定义结构体数组：**

```c
struct 结构体名
{
	成员表列
}数组名【数组长度】;
```

```c
声明一个结构体类型
结构体类型 数组名【数组长度】;
```

## 结构体指针

**结构体指针：**指向结构体变量的指针，一个结构体变量的起始位置就是这个结构体变量的指针

* 指向结构体变量的指针，stu.num = (*p),num = p->num
* 指向结构体数组的指针，指针类型和结构体变量基类型必须相同
* 用结构体变量和结构体变量的指针做函数参数

## 链表

**链表：**动态的进行存储分配的一种数据结构

链表有头指针、结点、表尾，必须依靠指针变量才能实现，一个节点中包含一个指针变量，用它存放下一个结点的位置

## 共用体类型

**共用体类型：**几个不同的变量共享同一段内存的结构

```c
union 共用体名
{
	成员表列
}变量表列；
```

* 共同体变量所占的内存长度等于最长的成员的长度
* 不能引用共用体变量，只能引用共用体变量的成员
* 一个内存段可以用来存放几种不同类型的成员，但是一瞬时只能存放其中的一个，而不同同时存放几个
* 可以对共用体变量初始化，但是初始化表只能有一个变量
* 共用题变量起作用的是最后一次被赋值的成员
* 共同体变量和它的各成员的地址都是同一地址
* 不能引用或者对共用体变量幅值
* 共用体类型可以出现在结构体类型定义中，亦可以定义共用体数组

## 枚举类型

**枚举类型：**一个变量只有集中可能地值

```c
enum [枚举名]{枚举元素列表}；
```

* 枚举元素为常量，不可赋值
* 每一个枚举元素都代表一个整数，从0,1,2,3，...
* 枚举元素可以用来作判断比较

## typedef声明新类型名

* 先按定义变量的方法写出定义体（如int i;）
* 将变量名换成新类型名（将i换成Count）
* 在最前面加上`typedef`（typedef int Count）
* 然后可以用新类型名去定义变量

# Chapter10 文件操作

## C文件

**程序文件：**源程序文件.c 目标文件.obj 可执行文件.exe

**数据文件：**文本文件（ASCII文件）和二进制文件

* 文本文件：字节和字符一一对应，一个字节代表一个字符，便于对字符进行逐个处理，也便于输出字符，但一般占存储空间多，而且花费转换时间
* 二进制文件：可以节省外存空间和转换时间，每一个字节不一定代表一个字符，在读写过程中常用二进制文件，无需转换

**文件名：**包络文件路径 文件名主干 文件后缀

`D:\CC\temp\file1.dat`

**文件缓冲区：**系统自动地在内存区为程序中每一个正在使用的文件开辟一个文件缓存区

**文件类型指针：**每个被使用的文件都在内存中开辟了一个相应的文件信息区，用来存放文件相关的信息（文件名、文件状态和文件当前位置等）。这些信息保存在一个***结构体变量***中，该结构体变量由系统声明的，取名为` FILE `

```c
FILE *fp;
```

定义fp是一个指向FILE类型数据的指针变量，通过文件指针变量fp能够找到与它相关联的文件，n个文件应设n个指针用来实现对n个文件的访问

## 打开和关闭文件

**打开文件：**是指为文件建立相应的信息区和文件缓冲区

```c
fopen(文件名，使用文件方式)；
fopen("file.dat", "r");
```

**关闭文件：**是指撤销文件信息区和文件缓冲区，使文件指针变量不再指向改文件

```c
fclose(文件指针)；
fclose(fp);
```

**文件检查：**文件打开时进行文件检查，如果不存在文件或者其它则报错

```c
if((fp = fopen("file1.dat", "r")) == NULL)
{
    printf("can not open the file\n");
    exit(0);//程序中止函数 在stdlib.h头函数中
}
```

## 顺序读写数据文件

**向文件读写字符：**

```c
fgetc(fp);  从fp指向的文件中读入一个字符
fputc(ch,fp);  把字符ch写到fp所指向的文件中
```

* **`feof(fp)`：**可以检查到文件读写位置标记是否移到文件的末尾，即文件是否结束

**向文件读写字符串：**

```c
fgets(str, n, fp);
//从fp文件中读入一个长度为n-1的字符串,存到字符数组str中
fputs(str, fp)//把str所指向的字符串写到fp指向的文件中
```

* `fgets fputs`以指定的文件为读写对象
* `gets puts`以终端为读写对象

**格式化读写文件：**

```c
fprintf(文件指针，格式化字符串，输出表列)；
fprintf(fp, "%d,%6.2f", i, f);
fscanf(文件指针，格式化字符串，输出表列)；
fscanf(fp,"%d,%f", &i, &f);
```

**二进制方式读写一组数据：**

```c
fread(buffer,size,count,fp);
fwrite(buffer,size,count,fp);
//buffer：是一个地址，比如数组首位置
//size：要读写的字节数
//count：要读多少个数据项（每个数据项长度为size）
//fp：FILE类型指正
for (i=0; i<10; i++)
{
    fread(&stud[i],sizeof(struct Student_type),1,fp);
    //每次读入结构体数组stu的一个元素
}
```

## 随机读写数据文件

**文件位置标记：**系统为每个文件设置了一个文件读写位置标记，用来指示接下来要读写的下一个位置

**文件位置标记的定位：**

* `rewind(fp)`函数使文件位置标记指向开头
* `fseek`函数改变文件位置标记

```c
fseek(文件类型指针，位移量，起始点)；
//起始点用0、1、2代替，分别表示文件开始位置、当前位置、文件末尾位置
//位移量以起始点为基点，向前移动的字节数，位移量应是long型数据
fseek(fp,100L,0);//将文件位置标记向前移到离文件开头100个字节处
fseek(fp,50L,1);//将文件位置标记向前移到离当前位置50个字节处
fseek(fp,-10L,2);//将文件位置标记从文件末尾处向后退10个字节
```

* `ftell`函数测定文件位置标记的当前位置

```c
i = ftell(fp);//变量i存放文件当前位置
```

## 文件读写的出错检测

* `ferror(fp)`函数：返回值为0表示未出错

* `clearerr(fp)`函数：使文件错误标志和文件结束标志置为0，假设在调用一个输入输出函数时出现错误，ferror函数值为一个非零值，应该立即调用clearerr函数使其置零，以便进行下一次检测

  

